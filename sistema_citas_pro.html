<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Orthogestión | Sistema de Programación de Citas</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    
    <style>
        /* ==================== VARIABLES Y ESTILOS BASE ==================== */
        :root {
            --color-primary: #FFC107; /* Amarillo/Naranja (principal) */
            --color-secondary: #FFF8E1; /* Beige claro (fondo/resaltado) */
            --color-text: #333333; /* Texto oscuro */
            --color-subtext: #666666; /* Texto secundario */
            --color-success: #28a745;
            --color-pending: #ff8c00;
            --color-bg-light: #f4f7f9; /* Fondo general */
        }
        
        body {
            font-family: 'Roboto', sans-serif;
            background-color: var(--color-bg-light);
            padding: 30px;
            color: var(--color-text);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 25px;
        }

        .card {
            background-color: white;
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            border-top: 4px solid var(--color-primary);
        }

        /* ==================== HEADER (Logo y Título) ==================== */
        header {
            grid-column: 1 / 3;
            display: flex;
            align-items: center;
            padding: 20px 0;
            margin-bottom: 20px;
            border-bottom: 1px solid #eee;
        }

        .logo-container {
            width: 70px;
            height: 70px;
            background-color: var(--color-primary);
            border-radius: 50%;
            margin-right: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2em;
            color: white;
        }

        header h1 {
            font-size: 1.8em;
            margin: 0;
            color: var(--color-text);
        }

        header p {
            font-size: 1em;
            color: var(--color-subtext);
            margin: 0;
        }

        /* ==================== FILTROS Y RESUMEN ==================== */
        .sidebar {
            grid-column: 1 / 2;
        }

        h2 {
            font-size: 1.4em;
            border-bottom: 2px solid var(--color-secondary);
            padding-bottom: 10px;
            margin-bottom: 20px;
            color: var(--color-text);
        }

        /* Filtro de Doctoras */
        .doctor-filter-item {
            cursor: pointer;
            border: 1px solid #ddd;
            border-radius: 25px;
            padding: 12px 20px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.2s;
            font-size: 0.95em;
        }

        .doctor-filter-item:hover {
            background-color: var(--color-secondary);
        }

        .doctor-filter-item.selected {
            border-color: var(--color-primary);
            background-color: var(--color-secondary);
            font-weight: 700;
        }

        .doctor-filter-item .specialty {
            color: var(--color-subtext);
            font-weight: 300;
            font-size: 0.9em;
        }

        .doctor-filter-item .check {
            color: var(--color-primary);
            font-size: 1.2em;
        }

        /* Resumen */
        .summary-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px dotted #eee;
        }

        .summary-value {
            font-weight: 700;
        }

        .summary-value.success { color: var(--color-success); }
        .summary-value.pending { color: var(--color-pending); }

        /* ==================== CALENDARIO Y CITAS ==================== */
        .main-content {
            grid-column: 2 / 3;
        }

        /* Calendario */
        .calendar-nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            font-weight: 700;
        }

        .calendar-nav button {
            background: none;
            border: 1px solid #ccc;
            border-radius: 5px;
            font-size: 1.1em;
            cursor: pointer;
            color: var(--color-text);
            padding: 8px 15px;
            transition: background-color 0.2s;
        }

        .calendar-nav button:hover {
            background-color: #f0f0f0;
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            text-align: center;
        }

        .day-header {
            font-weight: 700;
            padding: 10px 0;
            color: var(--color-subtext);
        }

        .day {
            padding: 12px 0;
            cursor: pointer;
            transition: all 0.1s;
            border-radius: 4px;
        }

        .day:hover:not(.empty) {
            background-color: var(--color-secondary);
        }

        .day.bold {
            font-weight: 700;
            color: var(--color-text);
        }

        .day.selected {
            background-color: var(--color-primary);
            color: white;
            font-weight: 700;
        }

        .calendar-footer-note {
            margin-top: 20px;
            font-size: 0.9em;
            color: var(--color-subtext);
        }
        
        /* Citas Detalle */
        .appointment-day-header {
            font-size: 1.3em;
            font-weight: 700;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--color-secondary);
            color: var(--color-text);
        }

        .appointment-day-header p {
            font-size: 0.9em;
            font-weight: 400;
            color: var(--color-subtext);
        }

        .appointment-list-item {
            border-left: 5px solid var(--color-primary);
            padding: 15px;
            margin-bottom: 15px;
            position: relative;
            background-color: #fafafa;
            border-radius: 4px;
        }

        .appointment-time { font-weight: 700; font-size: 1.1em; margin-bottom: 5px; }
        .appointment-info { font-size: 0.9em; line-height: 1.6; }
        .appointment-doctor { color: var(--color-primary); margin-top: 5px; font-weight: 500;}
        .appointment-note { font-style: italic; font-size: 0.85em; color: var(--color-subtext); margin-top: 8px; border-top: 1px dotted #ccc; padding-top: 5px;}
        
        .badge { 
            background-color: var(--color-pending); 
            color: white; 
            padding: 4px 10px; 
            border-radius: 15px; 
            font-size: 0.8em; 
            position: absolute; 
            right: 15px; 
            top: 15px; 
            font-weight: 500;
        }
    </style>
</head>
<body>

    <header>
        <div class="logo-container">
            <i class="fas fa-tooth"></i>
        </div>
        <div>
            <h1>Sistema de Citas - Ortho Guzmán</h1>
            <p>Ortodoncia & Odontología | Plataforma de Gestión de Agenda</p>
        </div>
    </header>

    <main class="container">
        
        <aside class="sidebar">
            
            <section class="card">
                <h2><i class="fas fa-user-md"></i> Filtro de Especialista</h2>
                <div id="doctor-filter-list">
                    </div>
            </section>

            <section class="card">
                <h2><i class="fas fa-chart-bar"></i> Resumen Operativo</h2>
                <div id="summary-data">
                    </div>
            </section>

        </aside>

        <article class="main-content">
            
            <section class="card calendar-container">
                <h2><i class="fas fa-calendar-alt"></i> Visualización de Agenda</h2>
                
                <div class="calendar-nav">
                    <button id="prev-month"><i class="fas fa-chevron-left"></i> Anterior</button>
                    <span id="current-month-year"></span>
                    <button id="next-month">Siguiente <i class="fas fa-chevron-right"></i></button>
                </div>

                <div id="calendar-grid" class="calendar-grid">
                    </div>
                
                <p class="calendar-footer-note">Los días en **negrita** indican disponibilidad o citas programadas.</p>
            </section>

            <section class="card appointment-schedule">
                <div id="appointment-day-header" class="appointment-day-header">
                    </div>
                
                <div id="appointments-list">
                    </div>
            </section>
        </article>
    </main>

    <script>
        // ==================== LÓGICA JAVASCRIPT AVANZADA ====================
        
        // 1. Definición de Datos (JSON)
        const DOCTORS = [
            { id: 1, name: "Dra. Raquel Guzmán Reyes", specialty: "Especialista en Ortodoncia" },
            { id: 2, name: "Dra. Paola Jazmin Vera Guzmán", specialty: "Especialista en Endodoncia" },
            { id: 3, name: "Dra. María Fernanda Cabrera Guzmán", specialty: "Cirujana Dentista" }
        ];

        // Datos de citas por día (Clave: AAAA-MM-DD)
        const APPOINTMENTS_DATA = {
            "2025-11-17": [
                { id: 101, time: "11:00 - 12:00", patient: "Antonio Jiménez", service: "Extracción", phone: "+52 121-796-2156", doctorId: 1, status: "Pendiente" },
                { id: 102, time: "14:00 - 14:30", patient: "Elena Vargas", service: "Endodoncia", phone: "+52 112-180-3739", doctorId: 2, status: "Pendiente", note: "Primera consulta - Revisar historial RX" },
                { id: 103, time: "16:00 - 17:00", patient: "Carlos Torres", service: "Consulta de Valoración", doctorId: 3, status: "Completada" },
                { id: 104, time: "17:00 - 18:00", patient: "Ana López", service: "Revisión Ortodoncia", doctorId: 1, status: "Completada" },
                { id: 105, time: "18:00 - 19:00", patient: "Javier Ríos", service: "Limpieza Dental", doctorId: 2, status: "Pendiente" },
                { id: 106, time: "19:00 - 20:00", patient: "Sofía Díaz", service: "Endodoncia", doctorId: 2, status: "Completada" },
            ],
            "2025-11-18": [{ id: 201, time: "09:00 - 10:00", patient: "Roberto Pérez", service: "Consulta", doctorId: 1, status: "Pendiente" }],
            "2025-11-20": [{ id: 301, time: "10:00 - 11:00", patient: "Laura Garza", service: "Endodoncia", doctorId: 2, status: "Pendiente" }],
            "2025-12-05": [{ id: 401, time: "10:00 - 11:00", patient: "Marco Ruiz", service: "Extracción", doctorId: 3, status: "Pendiente" }],
        };

        // 2. Estado de la Aplicación
        let appState = {
            currentDate: new Date(2025, 10, 17), // Noviembre (10)
            selectedDoctorId: 1, 
            selectedDay: "2025-11-17"
        };
        
        // 3. Funciones de Ayuda
        
        /**
         * Traduce el estado de la cita a una clase CSS.
         */
        const getStatusClass = (status) => {
            if (status === "Completada") return "success";
            if (status === "Pendiente") return "pending";
            return "default";
        };

        /**
         * Formatea una fecha para el encabezado del detalle de citas.
         */
        const formatAppointmentHeader = (dateStr) => {
            const date = new Date(dateStr + "T00:00:00"); // Asegura la zona horaria correcta
            const dayNamesLong = ["Domingo", "Lunes", "Martes", "Miércoles", "Jueves", "Viernes", "Sábado"];
            const monthNamesLong = ["Enero", "Febrero", "Marzo", "Abril", "Mayo", "Junio", "Julio", "Agosto", "Septiembre", "Octubre", "Noviembre", "Diciembre"];

            return {
                formattedDate: `${dayNamesLong[date.getDay()]}, ${date.getDate()} De ${monthNamesLong[date.getMonth()]} De ${date.getFullYear()}`,
                dateKey: `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}-${String(date.getDate()).padStart(2, '0')}`
            };
        };

        // 4. Renderizado

        /**
         * Renderiza la lista de doctoras.
         */
        function renderDoctorFilter() {
            const listContainer = document.getElementById('doctor-filter-list');
            listContainer.innerHTML = DOCTORS.map(doctor => `
                <div class="doctor-filter-item ${doctor.id === appState.selectedDoctorId ? 'selected' : ''}" data-id="${doctor.id}">
                    <span>${doctor.name} <span class="specialty">${doctor.specialty}</span></span>
                    <span class="check">${doctor.id === appState.selectedDoctorId ? '<i class="fas fa-check-circle"></i>' : ''}</span>
                </div>
            `).join('');

            listContainer.querySelectorAll('.doctor-filter-item').forEach(item => {
                item.addEventListener('click', function() {
                    appState.selectedDoctorId = parseInt(this.getAttribute('data-id'));
                    renderApp(); // Renderiza toda la aplicación
                });
            });
        }
        
        /**
         * Genera el calendario.
         */
        function renderCalendar() {
            const container = document.getElementById('calendar-grid');
            const monthYearSpan = document.getElementById('current-month-year');
            container.innerHTML = '';
            
            const monthNames = ["Enero", "Febrero", "Marzo", "Abril", "Mayo", "Junio", "Julio", "Agosto", "Septiembre", "Octubre", "Noviembre", "Diciembre"];
            const dayNames = ["LU", "MA", "MI", "JU", "VI", "SÁ", "DO"];

            const { currentDate } = appState;
            const year = currentDate.getFullYear();
            const month = currentDate.getMonth();
            
            monthYearSpan.textContent = `${monthNames[month].toUpperCase()} ${year}`;

            // Días de la semana
            dayNames.forEach(day => {
                container.innerHTML += `<div class="day-header">${day}</div>`;
            });
            
            const firstDayOfMonth = new Date(year, month, 1).getDay();
            const startDayIndex = (firstDayOfMonth === 0 ? 6 : firstDayOfMonth - 1); 

            // Días vacíos
            for (let i = 0; i < startDayIndex; i++) {
                container.innerHTML += `<div class="day empty"></div>`;
            }

            // Días del mes
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            for (let day = 1; day <= daysInMonth; day++) {
                const dateString = `${year}-${String(month + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                
                // Determinar si el día tiene citas (simulando los días en negrita)
                const hasAppointments = APPOINTMENTS_DATA[dateString] !== undefined;
                const isSelected = dateString === appState.selectedDay;

                container.innerHTML += `
                    <div 
                        class="day ${hasAppointments ? 'bold' : ''} ${isSelected ? 'selected' : ''}"
                        data-date="${dateString}">
                        ${day}
                    </div>
                `;
            }
            
            // Eventos de click para seleccionar el día
            container.querySelectorAll('.day:not(.empty)').forEach(dayElement => {
                dayElement.addEventListener('click', function() {
                    const newSelectedDay = this.getAttribute('data-date');
                    if (newSelectedDay) {
                        appState.selectedDay = newSelectedDay;
                        renderApp();
                    }
                });
            });
        }
        
        /**
         * Renderiza el resumen y el detalle de las citas.
         */
        function renderAppointments() {
            const appointments = APPOINTMENTS_DATA[appState.selectedDay] || [];
            
            // Aplicar filtro por Doctora
            const filteredAppointments = appointments.filter(cita => cita.doctorId === appState.selectedDoctorId);

            const total = filteredAppointments.length;
            const pending = filteredAppointments.filter(c => c.status === "Pendiente").length;
            const completed = filteredAppointments.filter(c => c.status === "Completada").length;
            const inProgress = filteredAppointments.filter(c => c.status === "En curso").length;

            const { formattedDate } = formatAppointmentHeader(appState.selectedDay);
            const doctor = DOCTORS.find(d => d.id === appState.selectedDoctorId);

            // 1. Resumen Operativo
            document.getElementById('summary-data').innerHTML = `
                <div class="summary-item"><span>Citas Totales:</span><span class="summary-value">${total}</span></div>
                <div class="summary-item"><span>Pendientes de Atención:</span><span class="summary-value pending">${pending}</span></div>
                <div class="summary-item"><span>En Curso:</span><span class="summary-value">0</span></div>
                <div class="summary-item"><span>Concluidas:</span><span class="summary-value success">${completed}</span></div>
            `;
            
            // 2. Encabezado del Detalle
            document.getElementById('appointment-day-header').innerHTML = `
                ${formattedDate}
                <p>${total} Citas Programadas para ${doctor.name.split(' ')[1]}</p>
            `;

            // 3. Lista de Citas
            const appointmentList = document.getElementById('appointments-list');
            if (filteredAppointments.length === 0) {
                 appointmentList.innerHTML = `<p>No se encontraron citas para la ${doctor.name} el día ${formattedDate}.</p>`;
                 return;
            }

            appointmentList.innerHTML = filteredAppointments.map(cita => `
                <div class="appointment-list-item">
                    <span class="badge ${getStatusClass(cita.status)}">${cita.status}</span>
                    <p class="appointment-time"><i class="far fa-clock"></i> ${cita.time}</p>
                    <div class="appointment-info">
                        <p><strong><i class="fas fa-user"></i> Paciente:</strong> ${cita.patient}</p>
                        <p><strong><i class="fas fa-notes-medical"></i> Servicio:</strong> ${cita.service}</p>
                        ${cita.phone ? `<p><strong><i class="fas fa-phone-alt"></i> Contacto:</strong> ${cita.phone}</p>` : ''}
                    </div>
                    <p class="appointment-doctor"><i class="fas fa-tag"></i> Atendido por: ${doctor.name}</p>
                    ${cita.note ? `<p class="appointment-note">Notas de Registro: ${cita.note}</p>` : ''}
                </div>
            `).join('');
        }
        
        // 5. Navegación del Calendario

        /**
         * Mueve el calendario al mes anterior.
         */
        function goToPreviousMonth() {
            appState.currentDate.setMonth(appState.currentDate.getMonth() - 1);
            // Establecer el día seleccionado al 1 del nuevo mes
            appState.selectedDay = new Date(appState.currentDate.getFullYear(), appState.currentDate.getMonth(), 1).toISOString().substring(0, 10);
            renderApp();
        }

        /**
         * Mueve el calendario al mes siguiente.
         */
        function goToNextMonth() {
            appState.currentDate.setMonth(appState.currentDate.getMonth() + 1);
            // Establecer el día seleccionado al 1 del nuevo mes
            appState.selectedDay = new Date(appState.currentDate.getFullYear(), appState.currentDate.getMonth(), 1).toISOString().substring(0, 10);
            renderApp();
        }

        // Función principal de renderizado (centraliza las llamadas)
        function renderApp() {
            renderDoctorFilter();
            renderCalendar();
            renderAppointments();
        }

        // Inicialización
        document.getElementById('prev-month').addEventListener('click', goToPreviousMonth);
        document.getElementById('next-month').addEventListener('click', goToNextMonth);

        // Renderizado inicial
        renderApp();
    </script>

</body>
</html>